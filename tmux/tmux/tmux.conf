# Portable tmux configuration
# Cross-platform setup with plugin management and session persistence

##### Terminal Support #####
# Use best available terminal type
if-shell 'infocmp -x tmux-256color >/dev/null 2>&1' \
  'set -g default-terminal "tmux-256color"' \
  'set -g default-terminal "screen-256color"'

##### Window & Pane Indexing #####
set -g base-index 1
setw -g pane-base-index 1
set -g renumber-windows on

##### Mouse Support #####
set -g mouse on

##### Visual Styling #####
# Status bar - vibrant with bright green accents
set -g status-style 'bg=#1e293b,fg=#f1f5f9'
set -g status-left ''
set -g status-right '#[fg=#22c55e,bg=#334155,bold] %H:%M #[fg=#f1f5f9,bg=#1e293b] %d/%m '

# Pane borders - bright and visible
set -g pane-border-style 'fg=#64748b'
set -g pane-active-border-style 'fg=#22c55e,bold'

# Window status - lively colors
set -g window-status-style 'fg=#cbd5e1,bg=#1e293b'
set -g window-status-current-style 'fg=#0f172a,bg=#22c55e,bold'
set -g window-status-format ' #I:#W '
set -g window-status-current-format ' #I:#W '

# Copy mode - bright green selection
set -g mode-style 'fg=#0f172a,bg=#22c55e,bold'

##### Key Bindings #####
# Pane splitting - inherit current directory
bind '"' split-window -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"
bind c new-window -c "#{pane_current_path}"

# Window navigation (ensure plugins don't override)
bind 1 select-window -t :=1
bind 2 select-window -t :=2
bind 3 select-window -t :=3
bind 4 select-window -t :=4

##### Session Persistence #####
set -g @continuum-restore 'on'
set -g @continuum-boot 'on'

##### Plugin Management #####
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# Initialize plugin manager
run '~/.tmux/plugins/tpm/tpm'

##### Alternative Prefix (uncomment to use Ctrl-a) #####
# set -g prefix C-a
# unbind C-b
# bind C-a send-prefix

##### Platform-Specific Overrides #####
if-shell 'test -f ~/.tmux.local.conf' 'source-file ~/.tmux.local.conf'
if-shell 'uname | grep -q Darwin' 'source-file ~/.tmux/mac.conf'
if-shell 'uname | grep -q Linux' 'source-file ~/.tmux/linux.conf'